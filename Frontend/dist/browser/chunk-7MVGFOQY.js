import{c as ye,d as ge}from"./chunk-KJDOYRD5.js";import{$ as O,R as q,S as k,T as N,U as R,V as P,W as j,X as I,Y as W,Z as G,_ as B,aa as Y}from"./chunk-ZRBDJC7I.js";import{a as ne,d as ie,e as ae,f as re,g as oe,h as le,i as me,m as de,n as se,o as pe,p as ue,q as ce,s as fe}from"./chunk-ECWPKNTX.js";import{Da as u,Ha as c,J as Z,K as V,N as ee,Sa as a,T as y,Ta as r,Tb as A,U as g,Ua as h,Va as C,Wa as S,Ya as te,Yb as f,_a as E,e as X,lb as o,lc as z,nb as _,pa as s,pb as b,qb as w,rb as M,ta as x,ya as v,za as F}from"./chunk-SC6NY4NB.js";import{a as T,b as K}from"./chunk-C6Q5SG76.js";var H=(()=>{class e{constructor(){this.harvests=[],this.harvestsSubject=new X([]),this.harvests$=this.harvestsSubject.asObservable(),this.plannedYields={"Field A":100,"Field B":150,"Field C":120}}addHarvest(t){this.harvests.push(t),this.harvestsSubject.next([...this.harvests])}getAll(){return this.harvests}getSummaryByField(){let t={};for(let n of this.harvests)t[n.field]=(t[n.field]||0)+n.quantity;return t}getPlannedVsActual(){let t=this.getSummaryByField(),n=new Set([...Object.keys(this.plannedYields),...Object.keys(t)]);return Array.from(n).map(i=>({field:i,plannedYield:this.plannedYields[i]??null,quantity:t[i]??0}))}exportToCSV(){let t=`data:text/csv;charset=utf-8,Field,Date,Worker,Quantity,Grade,Transport
`+this.harvests.map(m=>`${m.field},${m.date},${m.workerName},${m.quantity},${m.qualityGrade},${m.transportDetails}`).join(`
`),n=encodeURI(t),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","harvest_log.csv"),document.body.appendChild(i),i.click()}static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var L=(()=>{class e{constructor(t){this.harvestService=t,this.entry={field:"",date:"",workerName:"",quantity:0,qualityGrade:"",transportDetails:""}}save(){this.harvestService.addHarvest(T({},this.entry)),alert("Harvest Entry Saved!"),this.entry={field:"",date:"",workerName:"",quantity:0,qualityGrade:"",transportDetails:""}}static{this.\u0275fac=function(n){return new(n||e)(x(H))}}static{this.\u0275cmp=v({type:e,selectors:[["app-harvest-form"]],decls:40,vars:6,consts:[["harvestForm","ngForm"],[1,"rounded-lg","border","border-gray-200","bg-white","p-8"],[1,"text-foreground","mb-4","font-semibold"],[1,"grid","grid-cols-1","gap-6","md:grid-cols-2",3,"ngSubmit"],[1,"mb-1","block","text-sm","font-medium","text-gray-700"],["type","text","name","field","required","",1,"w-full","rounded-md","border","border-gray-300","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],["type","date","name","date","required","",1,"w-full","rounded-md","border","border-gray-300","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],["type","text","name","workerName","required","",1,"w-full","rounded-md","border","border-gray-300","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],["type","number","name","quantity","required","","min","0",1,"w-full","rounded-md","border","border-gray-300","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],["name","qualityGrade","required","",1,"w-full","rounded-md","border","border-gray-300","bg-white","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],["value","","disabled",""],[1,"md:col-span-2"],["name","transportDetails","rows","4",1,"w-full","rounded-md","border","border-gray-300","px-4","py-2","focus:outline-none","focus:ring-2","focus:ring-green-500",3,"ngModelChange","ngModel"],[1,"text-right","md:col-span-2"],["type","submit",1,"bg-primary","text-primary-foreground","flex-none","rounded-md","px-4","py-2.5","text-xs","font-semibold"]],template:function(n,i){if(n&1){let m=te();a(0,"div",1)(1,"h3",2),o(2,"Harvest Entry"),r(),a(3,"form",3,0),E("ngSubmit",function(){return y(m),g(i.save())}),a(5,"div")(6,"label",4),o(7,"Field"),r(),a(8,"input",5),M("ngModelChange",function(l){return y(m),w(i.entry.field,l)||(i.entry.field=l),g(l)}),r()(),a(9,"div")(10,"label",4),o(11,"Date"),r(),a(12,"input",6),M("ngModelChange",function(l){return y(m),w(i.entry.date,l)||(i.entry.date=l),g(l)}),r()(),a(13,"div")(14,"label",4),o(15,"Worker Name"),r(),a(16,"input",7),M("ngModelChange",function(l){return y(m),w(i.entry.workerName,l)||(i.entry.workerName=l),g(l)}),r()(),a(17,"div")(18,"label",4),o(19,"Quantity (kg)"),r(),a(20,"input",8),M("ngModelChange",function(l){return y(m),w(i.entry.quantity,l)||(i.entry.quantity=l),g(l)}),r()(),a(21,"div")(22,"label",4),o(23,"Quality Grade"),r(),a(24,"select",9),M("ngModelChange",function(l){return y(m),w(i.entry.qualityGrade,l)||(i.entry.qualityGrade=l),g(l)}),a(25,"option",10),o(26,"Select Grade"),r(),a(27,"option"),o(28,"Grade A"),r(),a(29,"option"),o(30,"Grade B"),r(),a(31,"option"),o(32,"Grade C"),r()()(),a(33,"div",11)(34,"label",4),o(35,"Transport Details"),r(),a(36,"textarea",12),M("ngModelChange",function(l){return y(m),w(i.entry.transportDetails,l)||(i.entry.transportDetails=l),g(l)}),r()(),a(37,"div",13)(38,"button",14),o(39," Save Entry "),r()()()()}n&2&&(s(8),b("ngModel",i.entry.field),s(4),b("ngModel",i.entry.date),s(4),b("ngModel",i.entry.workerName),s(4),b("ngModel",i.entry.quantity),s(4),b("ngModel",i.entry.qualityGrade),s(12),b("ngModel",i.entry.transportDetails))},dependencies:[f,fe,le,se,pe,ne,me,de,ie,ae,ce,ue,oe,re],encapsulation:2})}}return e})();function Se(e,d){e&1&&(a(0,"th",13),o(1," Field "),r())}function _e(e,d){if(e&1&&(a(0,"td",14),o(1),r()),e&2){let t=d.$implicit;s(),_(" ",t.field," ")}}function be(e,d){e&1&&(a(0,"th",13),o(1," Total Quantity (kg) "),r())}function we(e,d){if(e&1&&(a(0,"td",14),o(1),r()),e&2){let t=d.$implicit;s(),_(" ",t.quantity," ")}}function Me(e,d){e&1&&h(0,"tr",15)}function xe(e,d){e&1&&h(0,"tr",16)}function De(e,d){e&1&&(a(0,"div",17),o(1," No harvest data available. "),r())}var Q=(()=>{class e{constructor(t){this.harvestService=t,this.tableData=new Y,this.displayedColumns=["field","quantity"],this.dialog=ee(ye)}ngOnInit(){this.subscription=this.harvestService.harvests$.subscribe(t=>{let n={};for(let m of t)n[m.field]=(n[m.field]||0)+m.quantity;let i=Object.entries(n).map(([m,p])=>({field:m,quantity:p}));this.tableData.data=i})}openHarvestForm(){this.dialog.open(L,{width:"600px"})}exportLog(){let n=[["Field","Total Quantity"],...this.tableData.data.map(l=>[l.field,l.quantity.toString()])].map(l=>l.join(",")).join(`
`),i=new Blob([n],{type:"text/csv;charset=utf-8;"}),m=window.URL.createObjectURL(i),p=document.createElement("a");p.href=m,p.setAttribute("download","harvest-summary.csv"),document.body.appendChild(p),p.click(),document.body.removeChild(p)}ngOnDestroy(){this.subscription.unsubscribe()}get isEmptySummary(){return this.tableData.data.length===0}static{this.\u0275fac=function(n){return new(n||e)(x(H))}}static{this.\u0275cmp=v({type:e,selectors:[["app-harvest-summary"]],decls:18,vars:4,consts:[[1,"mb-4","mt-4","flex","items-center","justify-between"],[1,"text-foreground","font-semibold"],[1,"flex","space-x-4"],[1,"bg-muted","text-muted-foreground","hover:text-foreground","flex-none","rounded-md","px-4","py-2.5","text-xs","font-semibold",3,"click"],[1,"bg-primary","text-primary-foreground","flex-none","rounded-md","px-4","py-2.5","text-xs","font-semibold",3,"click"],["mat-table","",1,"mat-elevation-z2","w-full",3,"dataSource"],["matColumnDef","field"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","quantity"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mt-4 text-gray-500 text-center",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"mt-4","text-gray-500","text-center"]],template:function(n,i){n&1&&(a(0,"div",0)(1,"h3",1),o(2,"Harvest Summary"),r(),a(3,"div",2)(4,"button",3),E("click",function(){return i.exportLog()}),o(5," Export CSV "),r(),a(6,"button",4),E("click",function(){return i.openHarvestForm()}),o(7," Add Harvest "),r()()(),a(8,"table",5),C(9,6),u(10,Se,2,0,"th",7)(11,_e,2,1,"td",8),S(),C(12,9),u(13,be,2,0,"th",7)(14,we,2,1,"td",8),S(),u(15,Me,1,0,"tr",10)(16,xe,1,0,"tr",11),r(),u(17,De,2,0,"div",12)),n&2&&(s(8),c("dataSource",i.tableData),s(7),c("matHeaderRowDef",i.displayedColumns),s(),c("matRowDefColumns",i.displayedColumns),s(),c("ngIf",i.isEmptySummary))},dependencies:[f,A,ge,O,q,N,I,R,k,W,P,j,G,B],encapsulation:2})}}return e})();function He(e,d){e&1&&(a(0,"th",11),o(1," Field "),r())}function Ee(e,d){if(e&1&&(a(0,"td",12),o(1),r()),e&2){let t=d.$implicit;s(),_(" ",t.field," ")}}function Te(e,d){e&1&&(a(0,"th",11),o(1," Planned Yield (kg) "),r())}function Ve(e,d){if(e&1&&(a(0,"td",12),o(1),r()),e&2){let t,n=d.$implicit;s(),_(" ",(t=n.plannedYield)!==null&&t!==void 0?t:"N/A"," ")}}function Fe(e,d){e&1&&(a(0,"th",11),o(1," Actual Quantity (kg) "),r())}function Ae(e,d){if(e&1&&(a(0,"td",12),o(1),r()),e&2){let t=d.$implicit;s(),_(" ",t.quantity," ")}}function qe(e,d){e&1&&(a(0,"th",11),o(1," Variance (kg) "),r())}function ke(e,d){if(e&1&&(a(0,"td",12),o(1),r()),e&2){let t=d.$implicit;s(),_(" ",t.variance," ")}}function Ne(e,d){e&1&&h(0,"tr",13)}function Re(e,d){e&1&&h(0,"tr",14)}function Pe(e,d){e&1&&(a(0,"div",15),o(1,` No records found.
`),r())}var U=(()=>{class e{constructor(t){this.harvestService=t,this.displayedColumns=["field","plannedYield","quantity","variance"],this.dataSource=new Y}ngOnInit(){this.subscription=this.harvestService.harvests$.subscribe(()=>{let t=this.harvestService.getPlannedVsActual().map(n=>K(T({},n),{variance:n.plannedYield!=null?n.quantity-n.plannedYield:"N/A"}));this.dataSource.data=t})}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(n){return new(n||e)(x(H))}}static{this.\u0275cmp=v({type:e,selectors:[["app-planned-vs-actual"]],decls:18,vars:4,consts:[[1,"mb-4","mt-8","flex","items-center","justify-between","text-foreground","font-semibold"],["mat-table","",1,"mat-elevation-z8","w-full",3,"dataSource"],["matColumnDef","field"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","plannedYield"],["matColumnDef","quantity"],["matColumnDef","variance"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","text-gray-500 mt-4",4,"ngIf"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],[1,"text-gray-500","mt-4"]],template:function(n,i){n&1&&(a(0,"h2",0),o(1,` Planned vs. Actual Yield
`),r(),a(2,"table",1),C(3,2),u(4,He,2,0,"th",3)(5,Ee,2,1,"td",4),S(),C(6,5),u(7,Te,2,0,"th",3)(8,Ve,2,1,"td",4),S(),C(9,6),u(10,Fe,2,0,"th",3)(11,Ae,2,1,"td",4),S(),C(12,7),u(13,qe,2,0,"th",3)(14,ke,2,1,"td",4),S(),u(15,Ne,1,0,"tr",8)(16,Re,1,0,"tr",9),r(),u(17,Pe,2,0,"div",10)),n&2&&(s(2),c("dataSource",i.dataSource),s(13),c("matHeaderRowDef",i.displayedColumns),s(),c("matRowDefColumns",i.displayedColumns),s(),c("ngIf",i.dataSource.data.length===0))},dependencies:[f,A,O,q,N,I,R,k,W,P,j,G,B],encapsulation:2})}}return e})();var $=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275cmp=v({type:e,selectors:[["app-harvest"]],decls:2,vars:0,template:function(n,i){n&1&&h(0,"app-harvest-summary")(1,"app-planned-vs-actual")},dependencies:[f,Q,U],encapsulation:2})}}return e})();var je=[{path:"",component:$}],ve=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=F({type:e})}static{this.\u0275inj=V({imports:[z.forChild(je),z]})}}return e})();var ht=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=F({type:e})}static{this.\u0275inj=V({imports:[f,ve,$,L,Q,U]})}}return e})();export{ht as HarvestModule};
